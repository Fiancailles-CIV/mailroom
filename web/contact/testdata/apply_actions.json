[
    {
        "label": "noop",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": []
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "name": "Cathy",
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND name = 'Cathy'",
                "count": 1
            }
        ]
    },
    {
        "label": "set name",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "set_contact_name",
                    "name": "Kathy"
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "name": "Kathy",
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": [
                {
                    "type": "contact_name_changed",
                    "created_on": "2018-07-06T12:30:12.123456789Z",
                    "step_uuid": "efcd6cea-84b6-425e-a07b-e063716f96dd",
                    "name": "Kathy"
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND name = 'Kathy'",
                "count": 1
            }
        ]
    },
    {
        "label": "clear name",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "set_contact_name",
                    "name": ""
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": [
                {
                    "type": "contact_name_changed",
                    "created_on": "2018-07-06T12:30:20.123456789Z",
                    "step_uuid": "6ac2c4fe-4a72-4053-9a11-9b9d4f515140",
                    "name": ""
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND name = ''",
                "count": 1
            }
        ]
    },
    {
        "label": "set valid numeric field",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "set_contact_field",
                    "field": {
                        "key": "age",
                        "name": "Gender"
                    },
                    "value": "24"
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00",
                "fields": {
                    "age": {
                        "text": "24",
                        "number": 24
                    }
                }
            },
            "events": [
                {
                    "type": "contact_field_changed",
                    "created_on": "2018-07-06T12:30:29.123456789Z",
                    "step_uuid": "0a30f257-f811-4130-a78a-c04586c1e3c9",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "value": {
                        "text": "24",
                        "number": 24
                    }
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND fields = '{\"903f51da-2717-47c7-a0d3-f2f32877013d\": {\"text\": \"24\", \"number\": 24}}'",
                "count": 1
            }
        ]
    },
    {
        "label": "clear field",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "set_contact_field",
                    "field": {
                        "key": "age",
                        "name": "Gender"
                    },
                    "value": ""
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": [
                {
                    "type": "contact_field_changed",
                    "created_on": "2018-07-06T12:30:37.123456789Z",
                    "step_uuid": "5f832708-1430-4867-b5d0-6711b238001c",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "value": null
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND fields = '{}'",
                "count": 1
            }
        ]
    },
    {
        "label": "add group",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "add_contact_groups",
                    "groups": [
                        {
                            "name": "Doctors",
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00",
                "groups": [
                    {
                        "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                        "name": "Doctors"
                    }
                ]
            },
            "events": [
                {
                    "type": "contact_groups_changed",
                    "created_on": "2018-07-06T12:30:45.123456789Z",
                    "step_uuid": "fdb474aa-fe8a-4d3e-8515-dd4650cf5117",
                    "groups_added": [
                        {
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                            "name": "Doctors"
                        }
                    ]
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10000",
                "count": 1
            }
        ]
    },
    {
        "label": "remove group",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "remove_contact_groups",
                    "groups": [
                        {
                            "name": "Doctors",
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": [
                {
                    "type": "contact_groups_changed",
                    "created_on": "2018-07-06T12:30:53.123456789Z",
                    "step_uuid": "190e3236-23a8-48d1-aae1-769f40a26631",
                    "groups_removed": [
                        {
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                            "name": "Doctors"
                        }
                    ]
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10000",
                "count": 0
            }
        ]
    },
    {
        "label": "set contact language",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "set_contact_language",
                    "language": "fra"
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "language": "fra",
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00"
            },
            "events": [
                {
                    "type": "contact_language_changed",
                    "created_on": "2018-07-06T12:31:01.123456789Z",
                    "step_uuid": "a8665c42-341d-4a4a-9aea-595ab1895f96",
                    "language": "fra"
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE language = 'fra' and id = 10000",
                "count": 1
            }
        ]
    },
    {
        "label": "add URN",
        "method": "POST",
        "path": "/mr/contact/apply_actions",
        "body": {
            "org_id": 1,
            "contact_id": 10000,
            "actions": [
                {
                    "uuid": "8eebd020-1af5-431c-b943-aa670fc74da9",
                    "type": "add_contact_urn",
                    "scheme": "tel",
                    "path": "0788555111"
                }
            ]
        },
        "status": 200,
        "response": {
            "contact": {
                "uuid": "6393abc0-283d-4c9b-a1b3-641a035c34bf",
                "id": 10000,
                "language": "fra",
                "timezone": "America/Los_Angeles",
                "created_on": "2018-07-06T05:30:00.123457-07:00",
                "urns": [
                    "tel:0788555111"
                ]
            },
            "events": [
                {
                    "type": "contact_urns_changed",
                    "created_on": "2018-07-06T12:31:09.123456789Z",
                    "step_uuid": "60ab6284-71a4-4083-8383-661801bb0bfd",
                    "urns": [
                        "tel:0788555111"
                    ]
                }
            ]
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '0788555111'",
                "count": 1
            }
        ]
    }
]